{
    "contents" : "# Copyright: Will Schuerman. Friday, November 7th, 2014.\n\n# Initial inspection of see_she_expr identification data.\n\n# File Description:\n\n# Packages \n\nrequire(ggplot2)\nrequire(bear)\nrequire(lme4)\n\n# summary statistics for ident.data\nwith(ident.data, tapply(response, list(session, block), mean))\nd.summary <- summarySE(ident.data, measurevar=\"response\", groupvars=c(\"subj\", \"session\", \"block\"))\n\n# summary statistics for prod.data\nwith(prod.data, tapply(in.f1.50, list(session, block), mean, na.rm=T))\nwith(prod.data, tapply(in.f2.50, list(session, block), mean, na.rm=T))\n\n\ncomb.data <- merge(ident.summarized.data, prod.summarized.data, by.x = c(\"subj\", \"block\", \"session\"), by.y = c(\"subj\", \"block\", \"session\"), all.x=T, all.y=T)\n\n\n# add participant data. \n\nparticipant.log <- read.csv(\"ParticipantLog.csv\", header=T)\n\ncomb.data <- merge(comb.data, participant.log, by.x=\"subj\", by.y=\"SubjID\")\n\ncomb.data$age.group <- ifelse(comb.data$Age > 40, \"older\", \"younger\")\ncomb.data$age.group <- factor(comb.data$age.group)\n\n\n# get rid of two NA blocks, where we have no proportion data (and my script accidentally thinks we do. )\ncomb.data <- comb.data[-(c(95,178)),]\n\n\n\n\n# examine cases by whether or not that production block was greater or lesser than the baseline. \n\ncomb.data$compensation.dispersion <- ifelse(comb.data$centered.in.dispersion > 0, \"greater\", \"lesser\")\n\nd.summary <- summarySE(comb.data[comb.data$age.group==\"younger\"], measurevar=\"proportion\", groupvars=c(\"compensation.f2\", \"block\", \"session\"), na.rm=T)\ng1 <- ggplot(d.summary[which(d.summary$session==\"NoPert\"),], aes(x=as.factor(block), y=proportion,fill=compensation.f2))+\n         geom_bar(position=position_dodge(), stat=\"identity\")+\n         geom_errorbar(aes(ymin=proportion-se, ymax=proportion+se),\n                width=.2,position=position_dodge(.9))\ng2 <- ggplot(d.summary[which(d.summary$session==\"YesPert\"),], aes(x=as.factor(block), y=proportion, fill=compensation.f2))+\n  geom_bar(position=position_dodge(), stat=\"identity\")+\n  geom_errorbar(aes(ymin=proportion-se, ymax=proportion+se),\n                width=.2,position=position_dodge(.9))\n\nmultiplot(g1, g2, cols=2)\n\n\n\n\nd.summary <- summarySE(comb.data, measurevar=\"proportion\", groupvars=c(\"compensation.dispersion\", \"block\", \"session\"), na.rm=T)\ng1 <- ggplot(d.summary[which(d.summary$session==\"NoPert\"),], aes(x=as.factor(block), y=proportion,fill=compensation.dispersion))+\n  geom_bar(position=position_dodge(), stat=\"identity\")+\n  geom_errorbar(aes(ymin=proportion-se, ymax=proportion+se),\n                width=.2,position=position_dodge(.9))\ng2 <- ggplot(d.summary[which(d.summary$session==\"YesPert\"),], aes(x=as.factor(block), y=proportion, fill=compensation.dispersion))+\n  geom_bar(position=position_dodge(), stat=\"identity\")+\n  geom_errorbar(aes(ymin=proportion-se, ymax=proportion+se),\n                width=.2,position=position_dodge(.9))\n\nmultiplot(g1, g2, cols=2)\n\n\n# look at z.proportion\n\nd.summary <- summarySE(comb.data, measurevar=\"z.proportion\", groupvars=c(\"compensation.dispersion\", \"block\", \"session\"), na.rm=T)\ng1 <- ggplot(d.summary[which(d.summary$session==\"NoPert\"),], aes(x=as.factor(block), y=z.proportion,colour = compensation.dispersion, group=compensation.dispersion))+\n  geom_line()+\n  geom_point()+  \n  geom_errorbar(aes(ymin=z.proportion-se, ymax=z.proportion+se),width=.2)              # Width of the error bars\n\ng2 <- ggplot(d.summary[which(d.summary$session==\"YesPert\"),], aes(x=as.factor(block), y=z.proportion, colour = compensation.dispersion, group=compensation.dispersion))+\n  geom_line()+\n  geom_point()+  geom_errorbar(aes(ymin=z.proportion-se, ymax=z.proportion+se),\n                               width=.2)   \n\nmultiplot(g1, g2, cols=2)\n\n\n# look at z.proportion and dispersion as compensation\n\n\nd.summary <- summarySE(comb.data, measurevar=\"z.centered.proportion\", groupvars=c(\"compensation.dispersion\", \"block\", \"session\"), na.rm=T)\ng1 <- ggplot(d.summary[which(d.summary$session==\"NoPert\"),], aes(x=as.factor(block), y=z.centered.proportion,fill=compensation.dispersion))+\n  geom_bar(position=position_dodge(), stat=\"identity\")+\n  geom_errorbar(aes(ymin=z.centered.proportion-se, ymax=z.centered.proportion+se),\n                width=.2,position=position_dodge(.9))\ng2 <- ggplot(d.summary[which(d.summary$session==\"YesPert\"),], aes(x=as.factor(block), y=z.centered.proportion, fill=compensation.dispersion))+\n  geom_bar(position=position_dodge(), stat=\"identity\")+\n  geom_errorbar(aes(ymin=z.centered.proportion-se, ymax=z.centered.proportion+se),\n                width=.2,position=position_dodge(.9))\n\nmultiplot(g1, g2, cols=2)\n\n\nd.summary <- summarySE(comb.data, measurevar=\"in.dispersion\", groupvars=c(\"block\", \"compensation.f2\", \"session\"), na.rm=T)\ng1 <- ggplot(d.summary[which(d.summary$session==\"NoPert\"),], aes(x=as.factor(block), y=in.dispersion, fill=compensation.f2))+\n  geom_bar(position=position_dodge(), stat=\"identity\")\ng2 <- ggplot(d.summary[which(d.summary$session==\"YesPert\"),], aes(x=as.factor(block), y=in.dispersion, fill=compensation.f2))+\n  geom_bar(position=position_dodge(), stat=\"identity\")\n\nmultiplot(g1, g2, cols=2)\n\n\n# average f2 by block and session \n\npd <- position_dodge(.1)\nd.summary <- summarySE(comb.data, measurevar=\"ave.in.f2.50\", groupvars=c(\"session\", \"block\", \"subj\"))\nggplot(d.summary, aes(x=block, y=ave.in.f2.50, group=subj,colour=subj)) + \n  geom_errorbar(aes(ymin=ave.in.f2.50-se, ymax=ave.in.f2.50+se), width=.1, position=pd) +\n  geom_line(position=pd) +\n  geom_point(position=pd, size=3)\n\n\n\n\n# Doing macro to micro statistics, descriptive and t-tests, using the swirl guidelines:\n\n\nnopert <- summarySE(ident.summarized.data[ident.summarized.data$session==\"NoPert\",], measurevar=\"proportion\", groupvars=\"subj\")\nnopert.proportion <- nopert$proportion\n\nyespert <- summarySE(ident.summarized.data[ident.summarized.data$session==\"YesPert\",], measurevar=\"proportion\", groupvars=\"subj\")\nyespert.proportion <- yespert$proportion\n\n# 1. compute difference in sample means\nsampMean.nopert.proportion <- mean(nopert.proportion)\nsampMean.yespert.proportion <- mean(yespert.proportion)\n\ndiffSampMean <- sampMean.nopert.proportion - sampMean.yespert.proportion\n\n# 2. compute sample mean if null hypothesis were true (assumed difference in population means)\n\ndiffPopMean <- 0\n\n# 3. compute sample variance in each group\n\nsampVar.nopert.proportion <- var(nopert.proportion)\nsampVar.yespert.proportion <- var(yespert.proportion)\n\n# 5. compute sample size for each group\n\nnopert.proportion.n <- length(nopert.proportion)\nyespert.proportion.n <- length(yespert.proportion)\n\n\n# 6. manually compute two sample t-test\n\nnumer <- diffSampMean - diffPopMean\n\ndenom <- sqrt((sampVar.nopert.proportion/nopert.proportion.n) + (sampVar.yespert.proportion/yespert.proportion.n))\n\ntStat <- numer/denom\n\nmyDf <- (sampVar.nopert.proportion/nopert.proportion.n + sampVar.yespert.proportion/yespert.proportion.n)^2 / \n  ((sampVar.nopert.proportion/nopert.proportion.n)^2/(nopert.proportion.n - 1) + (sampVar.yespert.proportion/yespert.proportion.n)^2/(yespert.proportion.n - 1))\n\npVal1 <- pt(tStat, df= myDf, lower.tail=FALSE)\n\npVal <- pVal1*2\n\n\nt.test(nopert.proportion, yespert.proportion, alternative=\"two.sided\")\n\n# very not significant. \n\n\n\n# looking at the centered proportions\n\n\n\nnopert <- summarySE(ident.summarized.data[ident.summarized.data$session==\"NoPert\",], measurevar=\"centered.proportion\", groupvars=\"subj\")\nnopert.proportion <- nopert$centered.proportion\n\nyespert <- summarySE(ident.summarized.data[ident.summarized.data$session==\"YesPert\",], measurevar=\"centered.proportion\", groupvars=\"subj\")\nyespert.proportion <- yespert$centered.proportion\n\nt.test(nopert.proportion, yespert.proportion, alternative=\"two.sided\")\n\n\n# template for looking at each block. \n\nnopert <- summarySE(comb.data[comb.data$session==\"NoPert\" & comb.data$age.group==\"younger\",], measurevar=\"proportion\", groupvars=\"subj\", na.rm=T)\nnopert.proportion <- nopert$proportion\n\nyespert <- summarySE(comb.data[comb.data$session==\"YesPert\" & comb.data$age.group==\"younger\",], measurevar=\"proportion\", groupvars=\"subj\")\nyespert.proportion <- yespert$proportion\n\nt.test(nopert.proportion, yespert.proportion, alternative=\"two.sided\")\n\n\n\n\n\n\n\n# look at compensation by dispersion \ncomb.data$compensation.dispersion <- ifelse(comb.data$centered.in.dispersion > 0, \"greater\", \"lesser\")\n\n\nd.summary <- summarySE(comb.data[comb.data$age.group=='younger' & comb.data$session==\"NoPert\",], measurevar=\"proportion\", groupvars=c(\"block\", \"compensation.dispersion\"), na.rm=T)\n\ng1 <- ggplot(d.summary, aes(x=as.factor(block), y=proportion, fill=compensation.dispersion))+\n  geom_bar(position=position_dodge(), stat=\"identity\")+\n  geom_errorbar(aes(ymin=proportion-se, ymax=proportion+se),\n                width=.2,                    # Width of the error bars\n                position=position_dodge(.9))\n\n\nd.summary <- summarySE(comb.data[comb.data$age.group=='younger' & comb.data$session==\"YesPert\",], measurevar=\"proportion\", groupvars=c(\"block\", \"compensation.dispersion\"), na.rm=T)\n\ng2 <- ggplot(d.summary, aes(x=as.factor(block), y=proportion, fill=compensation.dispersion))+\n  geom_bar(position=position_dodge(), stat=\"identity\")+\n  geom_errorbar(aes(ymin=proportion-se, ymax=proportion+se),\n                width=.2,                    # Width of the error bars\n                position=position_dodge(.9))\n\nmultiplot(g1,g2, cols=2)\n\n\nd <- comb.data\n# ddply to summarise identident.data\nd.summarized <- ddply(d, c(\"block\", \"session\"), summarise, mean(proportion, na.rm=T))\n\n\n# rename variable.\nnames(d.summarized) <- c(\"block\", \"session\", \"proportion\")\n\n# set proportion of block 1 to 0 for each session, and see how boundary changes over time. \nd.summarized <- ddply(d.summarized, c(\"session\"), transform, centered.proportion = proportion-proportion[which(block==0)])\n\n\nggplot(d.summarized, aes(x=as.factor(block), y=centered.proportion, group=session, colour=session))+\n  geom_point(position=position_dodge(), stat=\"identity\")+\n  geom_line(position=position_dodge())\n  geom_errorbar(aes(ymin=centered.proportion-se, ymax=centered.proportion+se),\n                width=.2,                    # Width of the error bars\n                position=position_dodge(.9))\n\n# \n# with(comb.data[comb.data$age.group==\"younger\" & comb.data$block==5,], plot(change.in.dispersion, centered.proportion, type='n'))\n# with(comb.data[comb.data$age.group==\"younger\" & comb.data$block==5 & comb.data$session==\"NoPert\",], points(change.in.dispersion, centered.proportion, col = \"blue\"))\n# abline(lm(centered.proportion~change.in.dispersion, data= comb.data[comb.data$age.group==\"younger\" & comb.data$block==5 & comb.data$session==\"NoPert\",]), lty='dashed', col=\"blue\")\n# with(comb.data[comb.data$age.group==\"younger\" & comb.data$block==5 & comb.data$session==\"YesPert\",], points(change.in.dispersion, centered.proportion, col = \"red\"))\n# abline(lm(centered.proportion~change.in.dispersion, data= comb.data[comb.data$age.group==\"younger\" & comb.data$block==5 & comb.data$session==\"YesPert\",]), lty='dashed', col=\"red\")\n\n\n\nd1 <- summarySE(prod.data[which(!(prod.data$subj %in% c(3,4,5,24,25,26))),], measurevar=\"in.dispersion\", groupvars=c(\"session\", \"block\"))\nggplot(d1, aes(x=block, y=in.dispersion, colour=session,group=session))+\n  geom_line()+\n  geom_point()+  geom_errorbar(aes(ymin=in.dispersion-se, ymax=in.dispersion+se),\n                               width=.2)              # Width of the error bars\n\n\n\n\n\n\nsubj.dispersion <- ddply(prod.data, c(\"subj\"), transform, z.in.dispersion = scale(in.dispersion))\n",
    "created" : 1416835447487.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1896028775",
    "id" : "C950243C",
    "lastKnownWriteTime" : 1416326555,
    "path" : "U:/Projects/git_projects/see_she_expr/see_she_expr_analysis_1/statistical_analysis.R",
    "project_path" : "statistical_analysis.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}